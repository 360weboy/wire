<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>Launcher test</title>
	<script type="text/javascript">
		require = {
			baseUrl: './'
		};
	</script>
	<script src="require.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" src="wire.js"></script>
	<script type="text/javascript">
		wire({
			// There is nothing special about this array.  It's just an array of modules
			// whose only member happens to be a plugin, but we could define it at the top
			// level or at any depth.  So, the following would work just as well:
			// dom: { module: 'wire/dom' }
			// This seems like it could end up being a reasonable convention, tho.
			wire$plugins: [
				{ module: 'wire/dom' }
			],

			// The particular logger we want.
			// Pick either the AlertLogger or SilentLogger and reload.
			// Can inject concrete dependencies without having to modify Controller.
			logger: {
				module: 'test/test1/AlertLogger'
			},

			// Silly, but shows that native values can be declared as usual, and can be wired in
			name: "Test",
			number: 10,
			message: "I'm ready!",

			foo: {
				bar: {
					baz: 10
				}
			}
		},
		function(context) {
			console.log(context.get("foo"));
			// This is so simple that there's no reason to do it in a child context, but I want to
			// show how parent/child contexts work.  The child (below) will "inherit" the objects
			// from its parent (above)
			context.wire({
			// 	// Create and configure a controller
				controller: {
					module: 'test/test1/Controller',
					create: [{ "$ref": "name" }], // Call constructor with no params.  Need better syntax for this
			
					// Properties will be set after construction
					properties: {
						number: { "$ref": "number" },
						// logger: { "$ref": "logger" },
						messageNode: { "$ref" : "dom!node1" }, // inject reference to dom node by id
						foo: { "$ref": "foo" }
					},
					// Init function (named "ready") will be called after on DomReady
					// Allows > 1 function to be called
					init: {
						// Params, can be a single value/ref/module or a mixed array of them
						// e.g. [{ "$ref": "message" }] will work just fine here
						ready: { "$ref": "message" }
					}
				}
			},
			function(context2) {
				console.log(context2.get("controller").foo);
			});
		});
	</script>
</head>
<body>
	<div>
		<p id="node1"></p>
	</div>
</body>
</html>